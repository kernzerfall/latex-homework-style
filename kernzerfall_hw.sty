%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%- kernzerfall's LaTeX Theme for Homework -%%%%
%%%%-                                        -%%%%
%%%%- Revision: R6-24.05.2022                -%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ------ Requirements ------ %
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{kernzerfall_hw}[kernzerfall's LaTeX theme for Homework]
\RequirePackage[hidelinks]{hyperref}
\RequirePackage{csvsimple}
\RequirePackage{bookmark}

% ------ Inject boilerplate ------ %

\newcommand{\boilerplate}{
    % Geometry
    \usepackage[a4paper, top=2cm, left=2cm, right=2cm]{geometry}

    % Math Symbols
    \usepackage{amsmath}
    \usepackage{amssymb}
    \usepackage{mathtools}
    \usepackage{microtype}
    \usepackage{stmaryrd}

    % Graphics
    \usepackage{tikz}
    \usepackage{graphicx}
    \usepackage{pdfpages}

    % Fonts/Encoding
    \usepackage{lmodern}
    \usepackage[utf8]{inputenc}
    \usepackage[T1]{fontenc}

    % Code listings
    \usepackage{listings}

    % Colors
    \definecolor{codegreen}{rgb}{0,0.6,0}%
    \definecolor{codegray}{rgb}{0.5,0.5,0.5}%
    \definecolor{codepurple}{rgb}{0.58,0,0.82}%
    \definecolor{backcolour}{rgb}{0.95,0.95,0.92}%
    \definecolor{fosapblue}{RGB}{0,128,255}%
    \definecolor{fosappink}{RGB}{252,163,212}%
}

% ------ Metadata ------ %
\AtBeginDocument{
	\hypersetup{bookmarksnumbered=true,%
	}
}

% ------ Environment variables ------ %
\newcommand{\group}[1]{\renewcommand{\group}{#1}}
\newcommand{\@group}{}
\newcommand{\class}[1]{\renewcommand{\class}{#1}}
\newcommand{\@class}{}
\newcommand{\assignment}[1]{\renewcommand{\assignment}{#1}}
\newcommand{\@assignment}{}
\def \teamname{\,}
\newcommand{\team}[1]{\def \teamname{#1}}

% ------ Group Roster Table ------- %

% Path to CSV
% Default path: working directory/group.csv
\def \groupcsv{group.csv}
% Command to update csv path
\newcommand{\usegroupcsv}[1]{\def \groupcsv{#1}}

\newcommand{\makegrouproster}{%
    \begin{center}%
        \vspace{2em}%
        \csvreader[tabular=|l|c|,%
            table head=\hline\titlefont{Vor- und Nachname} & \titlefont{Matrikelnummer}\\\hline,%
            late after line=\\,%
            late after last line=\\\hline%
        ]{\groupcsv}%
        {name=\name, matrnr=\matrnr}%
        {\name & \matrnr}%
    \end{center}
}

% ------ Maketitle ------ %
\renewcommand{\maketitle}%
{%
    \title{\assignment}%
    \if \teamname {\,}%
        \author{\group}%
    \else%
        \author{\group~-~\teamname}%
    \fi%
    \subject{\class}%
    \hypersetup{%
        pdftitle={\@title},
        pdfauthor={\@author},
        pdfsubject={\@subject}
    }%
    \begin{center}%
        \titlefont%
        \large{\class\hfill\group} \\
        \normalsize{\assignment\hfill\teamname}\\
        \normalfont%
    \end{center}%
}

% ------ Little things to make my life easier ------ %
\newcommand{\sothat}{\,\,|\,\,}
\newcommand{\ds}[1]{\,\,{#1}\,\,}
\newcommand{\qed}{$\square$}
\newcommand{\qedright}{\hfill\qed}
\newcommand{\qea}{\lightning}

% Common math sets
\newcommand{\C}{\ensuremath{\mathbb C}}
\newcommand{\R}{\ensuremath{\mathbb R}}
\newcommand{\Q}{\ensuremath{\mathbb Q}}
\newcommand{\Z}{\ensuremath{\mathbb Z}}
\newcommand{\N}{\ensuremath{\mathbb N}}

% Common mathcal letters
\newcommand{\calA}{\ensuremath{\mathcal A}}
\newcommand{\calB}{\ensuremath{\mathcal B}}

% Drawing Finite Automata
\newcommand{\tikzfosap}{%
    \usetikzlibrary{automata, positioning, arrows, shapes.geometric}%
    \tikzset{%
        ->, % gerichtete Kanten
        >=stealth, % dicke Pfeile
        node distance=3cm, % min. Distanz zwischen Knoten
        every state/.style={thick, fill=gray!10}, % `state` Farbe und Dicke
        elliptic/.style={draw,ellipse},%
        initial text=$ $, % Text auf dem ersten Pfeil
        tree node/.style={fill=fosapblue, text=white, draw, circle, minimum width=0.85cm},%
        tree leaf/.style={fill=fosappink, text=black, rectangle,  minimum height=0.5cm,   minimum width=0.5cm,},%
    }
}

% lstlistings style
\newcommand{\codestyle}{%
    \lstdefinestyle{krnz_code}{%
        backgroundcolor=\color{backcolour},%
        commentstyle=\color{codegreen},%
        keywordstyle=\color{magenta},%
        numberstyle=\tiny\color{codegray},%
        stringstyle=\color{codepurple},%
        basicstyle=\ttfamily\footnotesize,%
        breakatwhitespace=false,%         
        breaklines=true,%                 
        captionpos=b,%                    
        keepspaces=true,%                 
        numbers=left,%                    
        numbersep=5pt,%                  
        showspaces=false,%                
        showstringspaces=false,%
        showtabs=false,%                  
        tabsize=2%
    }%
    \lstset{style=krnz_code}%
}